{"version":3,"file":"levels.js","sources":["../src/node_modules/levels.js"],"sourcesContent":["\n// IMPORTS /////////////////////////////////////////////////////////////////////\n\nimport _                                    from 'lodash';\nimport * as defaults                        from 'defaults';\nimport text                                 from 'text';\nimport { BadOptionsError }                  from 'error';\n\n// LEVEL NUMBERS ///////////////////////////////////////////////////////////////\n\nexport const isNumberValid = n =>\n\tNumber.isInteger(parseFloat(n)) && _.inRange(n, 8);\n\n// NORMALIZATION & DEFAULTS ////////////////////////////////////////////////////\n\nconst normArr = (arr, opts) => {\n\tif (arr.length > 8)\n\t\tthrow new BadOptionsError(opts, text.tooManyLevels(arr.length));\n\n\treturn arr.map(val => {\n\t\tif (val && _.isString(val)) return val;\n\t\tif (_.isNumber(val) && isFinite(val)) return val.toString();\n\t\tif (_.isNull(val) || _.isUndefined(val)) return;\n\n\t\tthrow new BadOptionsError(opts, text.levelNotString(val));\n\t});\n};\n\nconst normObj = (obj, opts) => {\n\tconst lvlNums = _.values(obj);\n\n\tfor (const num of lvlNums) {\n\t\tif (!isNumberValid(num))\n\t\t\tthrow new BadOptionsError(opts, text.invalidLevelNum(num));\n\t}\n\n\tconst duplicates =\n\t\t_(obj).countBy().pick(lvl => lvl > 1).keys().value();\n\n\tif (duplicates.length)\n\t\tthrow new BadOptionsError(opts, text.duplicateLevelNums(duplicates));\n\n\treturn _.reduce(obj, (arr, i, name) => {\n\t\tarr[i] = name;\n\t\treturn arr;\n\t}, []);\n};\n\nexport const normalize = (opts) => {\n\n\tlet custom = opts.levels;\n\n\tif (!_.isUndefined(custom) && !_.isNull(custom) && !_.isObject(custom))\n\t\tthrow new BadOptionsError(opts, text.levelsNotObj(typeof custom));\n\n\tif (!custom)\n\t\treturn defaults.levels.slice();\n\n\tcustom = _.isArray(custom) ? normArr(custom, opts) : normObj(custom, opts);\n\n\tconst levels = defaults.levels.map((lvl, i) => custom[i] || lvl);\n\n\tconst duplicates =\n\t\t_(levels).countBy().pick(count => count > 1).keys().value();\n\n\tif (duplicates.length)\n\t\tthrow new BadOptionsError(opts, text.duplicateLevels(duplicates));\n\n\treturn levels;\n};\n"],"names":[],"mappings":";;;;;;;;;;;;;;;;sBAGiD,QAAQ;;;;wBACR,UAAU;;IAA/C,QAAQ;;oBAC6B,MAAM;;;;qBACN,OAAO;;AAIjD,IAAM,aAAa,GAAG,SAAhB,aAAa,CAAG,CAAC;QAC7B,kBAAiB,UAAU,CAAC,CAAC,CAAC,CAAC,IAAI,oBAAE,OAAO,CAAC,CAAC,EAAE,CAAC,CAAC;CAAA,CAAC;;QADvC,aAAa,GAAb,aAAa;;AAK1B,IAAM,OAAO,GAAG,SAAV,OAAO,CAAI,GAAG,EAAE,IAAI,EAAK;AAC9B,KAAI,GAAG,CAAC,MAAM,GAAG,CAAC,EACjB,MAAM,WAXC,eAAe,CAWI,IAAI,EAAE,kBAAK,aAAa,CAAC,GAAG,CAAC,MAAM,CAAC,CAAC,CAAC;;AAEjE,QAAO,GAAG,CAAC,GAAG,CAAC,UAAA,GAAG,EAAI;AACrB,MAAI,GAAG,IAAI,oBAAE,QAAQ,CAAC,GAAG,CAAC,EAAE,OAAO,GAAG,CAAC;AACvC,MAAI,oBAAE,QAAQ,CAAC,GAAG,CAAC,IAAI,QAAQ,CAAC,GAAG,CAAC,EAAE,OAAO,GAAG,CAAC,QAAQ,EAAE,CAAC;AAC5D,MAAI,oBAAE,MAAM,CAAC,GAAG,CAAC,IAAI,oBAAE,WAAW,CAAC,GAAG,CAAC,EAAE,OAAO;;AAEhD,QAAM,WAlBC,eAAe,CAkBI,IAAI,EAAE,kBAAK,cAAc,CAAC,GAAG,CAAC,CAAC,CAAC;EAC1D,CAAC,CAAC;CACH,CAAC;;AAEF,IAAM,OAAO,GAAG,SAAV,OAAO,CAAI,GAAG,EAAE,IAAI,EAAK;AAC9B,KAAM,OAAO,GAAG,oBAAE,MAAM,CAAC,GAAG,CAAC,CAAC;;;;;;;AAE9B,oCAAkB,OAAO,4GAAE;OAAhB,GAAG;;AACb,OAAI,CAAC,aAAa,CAAC,GAAG,CAAC,EACtB,MAAM,WA3BA,eAAe,CA2BK,IAAI,EAAE,kBAAK,eAAe,CAAC,GAAG,CAAC,CAAC,CAAC;GAC5D;;;;;;;;;;;;;;;;AAED,KAAM,UAAU,GACf,yBAAE,GAAG,CAAC,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,UAAA,GAAG;SAAI,GAAG,GAAG,CAAC;EAAA,CAAC,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC;;AAEtD,KAAI,UAAU,CAAC,MAAM,EACpB,MAAM,WAlCC,eAAe,CAkCI,IAAI,EAAE,kBAAK,kBAAkB,CAAC,UAAU,CAAC,CAAC,CAAC;;AAEtE,QAAO,oBAAE,MAAM,CAAC,GAAG,EAAE,UAAC,GAAG,EAAE,CAAC,EAAE,IAAI,EAAK;AACtC,KAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC;AACd,SAAO,GAAG,CAAC;EACX,EAAE,EAAE,CAAC,CAAC;CACP,CAAC;;AAEK,IAAM,SAAS,GAAG,SAAZ,SAAS,CAAI,IAAI,EAAK;;AAElC,KAAI,MAAM,GAAG,IAAI,CAAC,MAAM,CAAC;;AAEzB,KAAI,CAAC,oBAAE,WAAW,CAAC,MAAM,CAAC,IAAI,CAAC,oBAAE,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,oBAAE,QAAQ,CAAC,MAAM,CAAC,EACrE,MAAM,WA/CC,eAAe,CA+CI,IAAI,EAAE,kBAAK,YAAY,CAAC,OAAO,MAAM,CAAC,CAAC,CAAC;;AAEnE,KAAI,CAAC,MAAM,EACV,OAAO,QAAQ,CAAC,MAAM,CAAC,KAAK,EAAE,CAAC;;AAEhC,OAAM,GAAG,oBAAE,OAAO,CAAC,MAAM,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,IAAI,CAAC,GAAG,OAAO,CAAC,MAAM,EAAE,IAAI,CAAC,CAAC;;AAE3E,KAAM,MAAM,GAAG,QAAQ,CAAC,MAAM,CAAC,GAAG,CAAC,UAAC,GAAG,EAAE,CAAC;SAAK,MAAM,CAAC,CAAC,CAAC,IAAI,GAAG;EAAA,CAAC,CAAC;;AAEjE,KAAM,UAAU,GACf,yBAAE,MAAM,CAAC,CAAC,OAAO,EAAE,CAAC,IAAI,CAAC,UAAA,KAAK;SAAI,KAAK,GAAG,CAAC;EAAA,CAAC,CAAC,IAAI,EAAE,CAAC,KAAK,EAAE,CAAC;;AAE7D,KAAI,UAAU,CAAC,MAAM,EACpB,MAAM,WA5DC,eAAe,CA4DI,IAAI,EAAE,kBAAK,eAAe,CAAC,UAAU,CAAC,CAAC,CAAC;;AAEnE,QAAO,MAAM,CAAC;CACd,CAAC;QArBW,SAAS,GAAT,SAAS"}