{"version":3,"file":"logger.js","sources":["../src/node_modules/logger.js"],"sourcesContent":["\n// IMPORTS /////////////////////////////////////////////////////////////////////\n\nimport _                                    from 'lodash';\nimport semver                               from 'semver';\nimport * as defaults                        from 'defaults';\nimport * as levelUtil                       from 'levels';\nimport codependency                         from 'codependency';\nimport net                                  from 'net';\nimport text                                 from 'text';\nimport tls                                  from 'tls';\nimport urlUtil                              from 'url';\nimport { build }                            from 'serialize';\nimport { Writable }                         from 'stream';\nimport { BadOptionsError, LogentriesError } from 'error';\n\n// SYMBOLS /////////////////////////////////////////////////////////////////////\n\nconst $bufferFull     = Symbol('bufferFull property');\nconst $cannotConnect  = Symbol('cannotConnect property');\nconst $connection     = Symbol('connection property');\nconst $console        = Symbol('console property');\nconst $failedAttempts = Symbol('failedAttempts property');\nconst $flatten        = Symbol('flatten property');\nconst $flattenArrays  = Symbol('flattenArrays property');\nconst $getConnection  = Symbol('getConnection method');\nconst $host           = Symbol('host property');\nconst $json           = Symbol('json property');\nconst $levels         = Symbol('levels property');\nconst $Logger         = Symbol('Logger property (winston / bunyan)');\nconst $minLevel       = Symbol('minLevel property');\nconst $port           = Symbol('port property');\nconst $replacer       = Symbol('replacer property');\nconst $secure         = Symbol('secure property');\nconst $serialize      = Symbol('serialize method');\nconst $tempLevel      = Symbol('tempLevel property (winston)');\nconst $timeout        = Symbol('timeout property');\nconst $timestamp      = Symbol('timestamp property');\nconst $token          = Symbol('token property');\nconst $toLevel        = Symbol('toLevel method');\nconst $withLevel      = Symbol('withLevel property');\nconst $withStack      = Symbol('withStack property');\n\n// PATTERNS ////////////////////////////////////////////////////////////////////\n\nconst newline      = /\\n/g;\nconst tokenPattern = /[a-f\\d]{8}-([a-f\\d]{4}-){3}[a-f\\d]{12}/;\n\n// UTIL ////////////////////////////////////////////////////////////////////////\n\nconst finalizeLogString = (log, token) =>\n\t`${ token } ${ log.toString().replace(newline, '\\u2028') }\\n`;\n\nconst getConsoleMethod = lvl => {\n\treturn lvl == 3 ? 'warn' : lvl > 3 ? 'error' : 'log';\n};\n\nconst getSafeProp = (log, prop) => {\n\twhile (prop in log) prop = '_' + prop;\n\treturn prop;\n};\n\nconst requirePeer = codependency.register(module);\n\n// DECORATORS //////////////////////////////////////////////////////////////////\n\nconst nonConfigurable = (target, name, descriptor) => {\n\tdescriptor.configurable = false;\n\tdescriptor.enumerable = true;\n\treturn descriptor;\n};\n\nconst unwritable = (target, name, descriptor) => {\n\tdescriptor.writable = false;\n\treturn descriptor;\n};\n\nconst enumerable = (target, name, descriptor) => {\n\tdescriptor.enumerable = true;\n\treturn descriptor;\n};\n\n// LOGGER //////////////////////////////////////////////////////////////////////\n\nexport default class Logger extends Writable {\n\tconstructor(opts) {\n\t\tsuper({\n\t\t\tobjectMode: true,\n\t\t\thighWaterMark: opts.bufferSize || defaults.bufferSize\n\t\t});\n\n\t\t// Sanity checks\n\n\t\tif (_.isUndefined(opts))\n\t\t\tthrow new BadOptionsError(opts, text.noOptions());\n\n\t\tif (!_.isObject(opts))\n\t\t\tthrow new BadOptionsError(opts, text.optionsNotObj(typeof opts));\n\n\t\tif (_.isUndefined(opts.token))\n\t\t\tthrow new BadOptionsError(opts, text.noToken());\n\n\t\tif (!_.isString(opts.token) || !tokenPattern.test(opts.token))\n\t\t\tthrow new BadOptionsError(opts, text.invalidToken(opts.token));\n\n\t\t// Log method aliases\n\n\t\tthis[$levels] = levelUtil.normalize(opts);\n\n\t\tfor (const lvlName of this.levels) {\n\t\t\tif (lvlName in this)\n\t\t\t\tthrow new BadOptionsError(opts, text.levelConflict(lvlName));\n\n\t\t\tObject.defineProperty(this, lvlName, {\n\t\t\t\tenumerable: true,\n\t\t\t\twritable: false,\n\t\t\t\tvalue() {\n\t\t\t\t\tthis.log.apply(this, [ lvlName, ...arguments ]);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t// Other permanent options\n\n\t\tthis[$token] = opts.token;\n\n\t\t// Editable options\n\n\t\tthis.port =\n\t\t\topts.port || (opts.secure ? defaults.portSecure : defaults.port);\n\n\t\tthis.flatten       = opts.flatten;\n\t\tthis.flattenArrays =\n\t\t\t'flattenArrays' in opts ? opts.flattenArrays : opts.flatten;\n\n\t\tthis.json          = opts.json;\n\t\tthis.host          = opts.host;\n\t\tthis.console       = opts.console;\n\t\tthis.minLevel      = opts.minLevel;\n\t\tthis.replacer      = opts.replacer;\n\t\tthis.timeout       = opts.timeout;\n\t\tthis.timestamp     = opts.timestamp;\n\t\tthis.withLevel     = 'withLevel' in opts ? opts.withLevel : true;\n\t\tthis.withStack     = opts.withStack;\n\t\tthis[$secure]      = opts.secure;\n\n\t\t// Other\n\n\t\tthis[$cannotConnect]  = false;\n\t\tthis[$failedAttempts] = 0;\n\t}\n\n\t// Stream methods\n\n\t@unwritable\n\tasync _write(log, enc, cb) {\n\t\tlog = finalizeLogString(log, this[$token]);\n\n\t\ttry {\n\t\t\tconst conn = await this[$getConnection]();\n\t\t\tconn.write(log);\n\n\t\t} catch (err) {\n\t\t\tthis.emit('error', err);\n\n\t\t} finally {\n\t\t\tcb();\n\t\t}\n\t}\n\n\t@unwritable\n\tend() {\n\t\tthis.on('connection drain', () => this.closeConnection());\n\t\tsuper.end(...arguments);\n\t}\n\n\t@unwritable\n\tsetDefaultEncoding() { /* no. */ }\n\n\t// Public methods\n\n\t@unwritable\n\t@enumerable\n\tlog(lvl, log) {\n\t\t// lvl is optional\n\t\tif (log === undefined) {\n\t\t\tlog = lvl;\n\t\t\tlvl = null;\n\t\t}\n\n\t\tlet lvlName;\n\n\t\tif (lvl || lvl === 0) {\n\t\t\t[ lvl, lvlName ] = this[$toLevel](lvl);\n\n\t\t\t// If lvl is present, it must be recognized\n\t\t\tif (!lvl && lvl !== 0) {\n\t\t\t\tthis.emit('error', new LogentriesError(text.unknownLevel(lvl)));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// If lvl is below minLevel, it is dismissed\n\t\t\tif (lvl < this.minLevel)\n\t\t\t\treturn;\n\t\t}\n\n\t\t// If log is an array, it is treated as a collection of log events\n\t\tif (_.isArray(log)) {\n\t\t\tif (log.length)\n\t\t\t\tfor (const $log of log) this.log(lvl, $log);\n\t\t\telse\n\t\t\t\tthis.emit('error', new LogentriesError(text.noLogMessage()));\n\n\t\t\treturn;\n\t\t}\n\n\t\t// If log is an object, it is serialized to string and may be augmented\n\t\t// with timestamp and level. For strings, these may be prepended.\n\n\t\tif (_.isObject(log)) {\n\n\t\t\tlet safeTime, safeLevel;\n\n\t\t\tif (this.timestamp) {\n\t\t\t\tsafeTime = getSafeProp(log, 'time');\n\t\t\t\tlog[safeTime] = new Date();\n\t\t\t}\n\n\t\t\tif (this.withLevel && lvlName) {\n\t\t\t\tsafeLevel = getSafeProp(log, 'level');\n\t\t\t\tlog[safeLevel] = lvlName;\n\t\t\t}\n\n\t\t\tlog = this[$serialize](log);\n\n\t\t\tif (!log) {\n\t\t\t\tthis.emit('error', new LogentriesError(text.serializedEmpty()));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.console)\n\t\t\t\tconsole[getConsoleMethod(lvl)](JSON.parse(log));\n\n\t\t\tif (safeTime) delete log[safeTime];\n\t\t\tif (safeLevel) delete log[safeLevel];\n\n\t\t} else {\n\t\t\tif (_.isEmpty(log)) {\n\t\t\t\tthis.emit('error', new LogentriesError(text.noLogMessage()));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlog = [ log.toString() ];\n\n\t\t\tif (this.withLevel && lvlName)\n\t\t\t\tlog.unshift(lvlName);\n\n\t\t\tif (this.timestamp)\n\t\t\t\tlog.unshift((new Date()).toISOString());\n\n\t\t\tlog = log.join(' ');\n\n\t\t\tif (this.console)\n\t\t\t\tconsole[getConsoleMethod(lvl)](log);\n\t\t}\n\n\t\tif (this[$bufferFull]) {\n\t\t\tthis.emit('error', new LogentriesError(text.bufferFull(log)));\n\t\t\treturn;\n\t\t}\n\n\t\tthis.emit('log', log);\n\n\t\tconst mayWriteFurther = this.write(log);\n\n\t\tif (!mayWriteFurther) {\n\t\t\tthis[$bufferFull] = true;\n\t\t\tthis.once('drain', () => this[$bufferFull] = false);\n\t\t}\n\t}\n\n\t@unwritable\n\t@enumerable\n\tcloseConnection() {\n\t\tif (!this[$connection]) return;\n\n\t\tthis[$connection].then(conn => conn.end());\n\t}\n\n\t// Private methods\n\n\t[$toLevel](val) {\n\t\tlet num;\n\n\t\tif (levelUtil.isNumberValid(val))\n\t\t\tnum = parseInt(parseInt(val)); // -0\n\t\telse\n\t\t\tnum = this[$levels].indexOf(val);\n\n\t\tconst name = this[$levels][num];\n\n\t\treturn name ? [ num, name ] : [];\n\t}\n\n\tasync [$getConnection](_resolve, _reject) {\n\t\t// The $connection property is a promise. On error, manual close, or\n\t\t// timeout, it deletes itself.\n\n\t\tif (this[$connection]) return this[$connection];\n\n\t\tif (this[$failedAttempts])\n\t\t\tawait new Promise(resolve => {\n\t\t\t\tsetTimeout(resolve, (this[$failedAttempts] ** 1.5) * 1000);\n\t\t\t});\n\n\t\tthis[$connection] = new Promise((resolve, reject) => {\n\t\t\tresolve = _resolve || resolve;\n\t\t\treject  = _reject || reject;\n\n\t\t\tif (this[$cannotConnect]) {\n\t\t\t\treject(new LogentriesError(text.cannotConnect()));\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst opts = {\n\t\t\t\thost: this.host,\n\t\t\t\tport: this.port\n\t\t\t};\n\n\t\t\tlet connection;\n\t\t\tlet resolved = false;\n\n\t\t\tif (this.secure)\n\t\t\t\tconnection = tls.connect(opts, () => {\n\t\t\t\t\tif (!connection.authorized) {\n\t\t\t\t\t\tthis[$failedAttempts]++;\n\t\t\t\t\t\tconst errMsg = connection.authorizationError;\n\t\t\t\t\t\tthis.emit(new LogentriesError(text.authError(errMsg)));\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif(tls && tls.CleartextStream && connection instanceof tls.CleartextStream){\n\t\t\t\t\t\t\t//Your node is ancient!\n\t\t\t\t\t\t\tthis.emit('connect');\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\telse\n\t\t\t\tconnection = net.createConnection(opts);\n\n\t\t\tconnection.setTimeout(this.timeout);\n\n\t\t\t// Expose the connection’s drain event\n\t\t\tconnection.on('drain', () =>\n\t\t\t\tsetImmediate(() => this.emit('connection drain'))\n\t\t\t);\n\n\t\t\t// This is an inactivity timeout, not a connection timeout\n\t\t\tconnection.on('timeout', () => {\n\t\t\t\tconnection.end();\n\t\t\t\tdelete this[$connection];\n\t\t\t});\n\n\t\t\t// Error rejects the promise\n\t\t\tconnection.on('error', () => {\n\t\t\t\tconnection.destroy();\n\t\t\t\tdelete this[$connection];\n\n\t\t\t\t// If this error occurred before a connection was established,\n\t\t\t\t// we will try again up to a point.\n\t\t\t\tif (!resolved) {\n\t\t\t\t\tthis[$failedAttempts]++;\n\n\t\t\t\t\tif (this[$failedAttempts] >= defaults.maxFailedAttempts) {\n\t\t\t\t\t\tthis[$cannotConnect] = true;\n\n\t\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\t\tthis[$cannotConnect] = false;\n\t\t\t\t\t\t}, defaults.retryTimeout);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis[$getConnection](resolve, reject);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Close will emit whether it was intended or error-caused:\n\t\t\tconnection.on('close', () => {\n\t\t\t\tdelete this[$connection];\n\n\t\t\t\tthis.emit('disconnected');\n\t\t\t});\n\n\t\t\t// This will probably never be triggered since the communication is\n\t\t\t// one-way, but just in case:\n\t\t\tconnection.on('end', () => {\n\t\t\t\tdelete this[$connection];\n\t\t\t});\n\n\t\t\t// Yay\n\t\t\tconnection.on('connect', () => {\n\t\t\t\tthis[$failedAttempts] = 0;\n\t\t\t\tresolved = true;\n\t\t\t\tresolve(connection);\n\n\t\t\t\tthis.emit('connected');\n\t\t\t});\n\t\t});\n\n\t\treturn this[$connection];\n\t}\n\n\t// Coercive settable options\n\n\t@nonConfigurable\n\tget console() { return this[$console]; }\n\tset console(val) { this[$console] = !!val; }\n\n\t@nonConfigurable\n\tget flatten() { return this[$flatten]; }\n\tset flatten(val) {\n\t\tthis[$flatten] = !!val;\n\t\tthis[$serialize] = build(this);\n\t}\n\n\t@nonConfigurable\n\tget flattenArrays() { return this[$flattenArrays]; }\n\tset flattenArrays(val) {\n\t\tthis[$flattenArrays] = !!val;\n\t\tthis[$serialize] = build(this);\n\t}\n\n\t@nonConfigurable\n\tget host() { return this[$host]; }\n\tset host(val) {\n\t\tif (!_.isString(val) || !val.length) {\n\t\t\tthis[$host] = defaults.host;\n\t\t\treturn;\n\t\t}\n\n\t\tval = val.replace(/^https?:\\/\\//, '');\n\n\t\tconst url = urlUtil.parse(`http://${ val }`);\n\n\t\tthis[$host] = url.hostname || defaults.host;\n\n\t\tif (url.port) this.port = url.port;\n\t}\n\n\t@nonConfigurable\n\tget minLevel() { return this[$minLevel]; }\n\tset minLevel(val) {\n\t\tconst [ num ] = this[$toLevel](val);\n\n\t\tthis[$minLevel] = _.isNumber(num) ? num : 0;\n\t}\n\n\t@nonConfigurable\n\tget port() { return this[$port]; }\n\tset port(val) {\n\t\tval = parseFloat(val);\n\t\tif (Number.isInteger(val) && _.inRange(val, 65536)) this[$port] = val;\n\t}\n\n\t@nonConfigurable\n\tget replacer() { return this[$replacer]; }\n\tset replacer(val) {\n\t\tthis[$replacer] = _.isFunction(val) ? val : undefined;\n\t\tthis[$serialize] = build(this);\n\t}\n\n\t@nonConfigurable\n\tget timeout() { return this[$timeout]; }\n\tset timeout(val) {\n\t\tif (Number.isInteger(val) && val >= 0)\n\t\t\tthis[$timeout] = parseInt(val);\n\n\t\tif (!_.isNumber(this[$timeout]))\n\t\t\tthis[$timeout] = defaults.timeout;\n\n\t\tthis.closeConnection();\n\t}\n\n\t@nonConfigurable\n\tget timestamp() { return this[$timestamp]; }\n\tset timestamp(val) { this[$timestamp] = !!val; }\n\n\t@nonConfigurable\n\tget withLevel() { return this[$withLevel]; }\n\tset withLevel(val) { this[$withLevel] = !!val; }\n\n\t@nonConfigurable\n\tget withStack() { return this[$withStack]; }\n\tset withStack(val) {\n\t\tthis[$withStack] = !!val;\n\t\tthis[$serialize] = build(this);\n\t}\n\n\t// Immutable properties\n\n\t@nonConfigurable\n\tget levels() { return this[$levels] && this[$levels].slice(); }\n\n\t@nonConfigurable\n\tget secure() { return this[$secure]; }\n\n\t// Exposed but externally immutable\n\n\t@nonConfigurable\n\tget serialize() { return this[$serialize]; }\n\n\t// Deprecated (to support migrants from le_node)\n\n\t@unwritable\n\tlevel(name) {\n\t\tconsole.warn(text.deprecatedLevelMethod());\n\t\tif (~this[$levels].indexOf(name)) this.minLevel = name;\n\t}\n\n\t@unwritable\n\twinston() {\n\t\tconsole.warn(text.deprecatedWinstonMethod());\n\t}\n\n\t// Static methods\n\n\t@unwritable\n\tstatic provisionWinston(winston) {\n\n\t\tif (winston.transports.Logentries) return;\n\n\t\tconst Transport = winston.Transport;\n\n\t\tclass LogentriesTransport extends Transport {\n\t\t\tconstructor(opts) {\n\t\t\t\tsuper(opts);\n\t\t\t\tthis.json = opts.json;\n\n\t\t\t\topts = _.clone(opts || {});\n\n\t\t\t\topts.minLevel =\n\t\t\t\t\topts.minLevel || opts.level || this[$tempLevel] || 0;\n\n\t\t\t\topts.levels = opts.levels || winston.levels;\n\t\t\t\tif (semver.satisfies(winston.version, '>=2.0.0')) {\n\t\t\t\t\t// Winston and Logengries levels are reversed\n\t\t\t\t\t// (i.e.: 'error' level is 0 for Winston and 5 for Logentries)\n\t\t\t\t\t// If the user provides custom levels we assue they are using winston standard\n\t\t\t\t\tlet levels = opts.levels;\n\t\t\t\t\tlet values = _.values(levels).reverse();\n\t\t\t\t\topts.levels = {};\n\t\t\t\t\t_.keys(levels).forEach((k, i) => opts.levels[k] = values[i]);\n\t\t\t\t}\n\n\t\t\t\tdelete this[$tempLevel];\n\n\t\t\t\tthis[$Logger] = new Logger(opts);\n\n\t\t\t\tthis[$Logger].on('error', err => this.emit(err));\n\t\t\t}\n\n\t\t\t@unwritable\n\t\t\t@enumerable\n\t\t\tlog(lvl, msg, meta, cb) {\n\t\t\t\tif(this.json){\n\t\t\t\t\tvar message = {\n\t\t\t\t\t\tmessage: msg\n\t\t\t\t\t};\n\t\t\t\t\tif(!_.isEmpty(meta))\n\t\t\t\t\t\tif(_.isObject(meta))\n\t\t\t\t\t\t\t_.defaults(message, meta);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tmessage.meta = meta;\n\n\n\t\t\t\t\tthis[$Logger].log(lvl, message);\n\t\t\t\t} else {\n\t\t\t\t\tif (!_.isEmpty(meta))\n\t\t\t\t\t\tif (_.isString(msg))\n\t\t\t\t\t\t\tmsg += ' ' + this[$Logger][$serialize](meta);\n\n\t\t\t\t\t\telse if (_.isObject(msg))\n\t\t\t\t\t\t\tmsg[getSafeProp(msg, 'meta')] = meta;\n\n\t\t\t\t\tthis[$Logger].log(lvl, msg);\n\t\t\t\t}\n\n\t\t\t\tsetImmediate(cb.bind(null, null, true));\n\t\t\t}\n\n\t\t\t@nonConfigurable\n\t\t\tget name() { return 'logentries'; }\n\n\t\t\t@nonConfigurable\n\t\t\tget level() {\n\t\t\t\tconst [ , lvlName ] =\n\t\t\t\t\tthis[$Logger][$toLevel](this[$Logger].minLevel);\n\n\t\t\t\treturn lvlName;\n\t\t\t}\n\t\t\tset level(val) {\n\t\t\t\tif (!this[$Logger])\n\t\t\t\t\tthis[$tempLevel] = val;\n\t\t\t\telse\n\t\t\t\t\tthis[$Logger].minLevel = val;\n\t\t\t}\n\n\t\t\t@nonConfigurable\n\t\t\tget levels() {\n\t\t\t\treturn this[$Logger].levels.reduce((acc, lvlName, lvlNum) => {\n\t\t\t\t\tacc[lvlName] = lvlNum;\n\t\t\t\t\treturn acc;\n\t\t\t\t}, {});\n\t\t\t}\n\t\t}\n\n\t\twinston.transports.Logentries = LogentriesTransport;\n\t}\n\n\tstatic bunyanStream(opts) {\n\t\tconst stream      = new BunyanStream(opts);\n\t\tconst [ , level ] = stream[$Logger][$toLevel](stream[$Logger].minLevel);\n\t\tconst type        = 'raw';\n\t\tconst name        = 'logentries';\n\n\t\t// Defer to Bunyan’s handling of minLevel\n\n\t\tstream[$Logger].minLevel = 0;\n\n\t\treturn { level, name, stream, type };\n\t}\n}\n\n// PROVISION WINSTON ///////////////////////////////////////////////////////////\n\nconst winston = requirePeer('winston', { optional: true });\n\nif (winston) Logger.provisionWinston(winston);\n\n// Provision too the winston static versions for testing/development purposes\nconst winston1 = requirePeer('winston1', { optional: true });\nconst winston2 = requirePeer('winston2x', { optional: true });\n\nif (winston1) Logger.provisionWinston(winston1);\nif (winston2) Logger.provisionWinston(winston2);\n\n// BUNYAN STREAM ///////////////////////////////////////////////////////////////\n\nclass BunyanStream extends Writable {\n\tconstructor(opts) {\n\t\tsuper({\n\t\t\tobjectMode: true,\n\t\t\thighWaterMark: opts.bufferSize || defaults.bufferSize\n\t\t});\n\n\t\topts = _.clone(opts || {});\n\n\t\topts.timestamp = false;\n\t\topts.levels    = opts.levels || defaults.bunyanLevels;\n\n\t\tthis[$Logger] = new Logger(opts);\n\n\t\tthis[$Logger].on('error', err => this.emit(err));\n\t}\n\n\t@unwritable\n\t_write(log, enc, cb) {\n\t\tconst lvl = (log.level / 10) - 1;\n\n\t\tthis[$Logger].log(lvl, log);\n\n\t\tsetImmediate(cb);\n\t}\n}\n"],"names":[],"mappings":"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"}